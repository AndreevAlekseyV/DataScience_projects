# Поиск "токсичных" комментариев.

## Задача
Интернет-магазин запускает новый сервис, в котором пользователи могут редактировать и дополнять описания товаров, как в вики-сообществах. Необходимо разработать модель классификации комментариев на позитивные и негативные. В распоряжении имеется набор данных с разметкой о токсичности правок. 

Разработанная модель должна иметь значение метрики качества *F1* не меньше 0.75. 

## Выводы и заключение
1. Для создания моделей ML была выполнена обработка датафрейма, а именно:
   - Текстовые признаки "почищены" и лемматизорованы.
   - Выполнено деление датафрейма на тренировочную, валидационную и тестовую выборки;
   - Выполнена векторизация текстовых признаков путём расчёта показателей TFIDF.
   - Для тренировочных данных выполнена балансировка классов по целевому показателю (исходный дисбаланс составлял 1:9). Обучение моделей выполнялось как по исходным тренировочным данным, так и по преобразованным (сбалансированным).
2. В ходе выполнения работы были созданы следующие модели ML:
   - Модели логистической регрессии:
      - Модель model_lr_base, обученной на исходных несбалансированных данных;
      - Модель model_lr_rus, обученной на сбалансированных данных;
   - Модели на основе случаного леса:
      - Модель model_rf_base, обученной на исходных несбалансированных данных;
      - Модель model_rf_rus, обученной на сбалансированных данных;
   - Модели градиентного бустинга с линейным классификатором:
      - Модель model_sgd_base, обученной на исходных несбалансированных данных;
      - Модель model_sgd_rus, обученной на сбалансированных данных;
   - Модель model_cb градиентного бустинга на основе CatBoost, обученную только на сбалансированных данных;
3. Каждая модель была обучена на тренировочных данных и для каждой даполнительно подбирался порог принятия решения.
4. По результатам оценки работы моделей на валидационных данных было установлено, что требованиям задачи отвечают все модели, кроме моделей случайного леса.
5. В качестве наилучшей модели выбрана модель *model_lr_base*. Для данной модели значение F1-меры, полученное на валидационных данных составило 0,777.
6. По результатам оценки работы модели на тестовой выборке F1-мера для выбранной модели составила 0,782, что соответствует требованию поставленной задачи (F1-мера должна быть не менее 0,75).

   **Проект является завершённым. Разработанная модель отвечает требованиям задачи**

## Системные требования и данные по развёртыванию тетрадки.
Системные требования:
1. Операционная система: Windows 10 или выше;
2. Версия языка Python: 3.9.13 или выше.
   
Требования к версиям библиотек:
- Версия pandas: 1.4.4;
- Версия numpy: 1.24.3;
- Версия scipy: 1.9.1;
- Версия matplotlib: 3.5.2;
- Версия seaborn: 0.11.2;
- Версия spacy: 3.7.2;
- Версия sklearn: 1.0.2;
- Версия catboost: 1.2;
- Версия phik: 0.12.3;
- Версия imblearn: 0.11.0;
- Версия tqdm: 4.64.1.
  
Для их установки Вы можете ввести в кодовой ячейке Jupyter следующий код:
```
!pip install pandas==1.4.4
!pip install numpy==1.24.3
!pip install scipy==1.9.1
!pip install matplotlib==3.5.2
!pip install seaborn==0.11.2
!pip install spacy==3.7.2
!pip install scikit-learn==1.0.2
!pip install catboost==1.2
!pip install phik==0.12.3
!pip install imbalanced-learn==0.11.0
!pip install tqdm==4.64.1
```
